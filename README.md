# WebAR 粒子互动系统 & 圣诞树交互系统

这是一个基于 Three.js 和 MediaPipe Hands 的 WebAR 互动应用集合，包含两个完整的3D交互体验：粒子系统和圣诞树系统。

## 🌟 核心功能

### 粒子互动系统 (WebARParticleSystem.html)
- **16,000个青色流体粒子**：高性能Fibonacci球面分布算法
- **物理引擎**：基于速度+加速度的真实物理模型
- **五态手势识别**：
  - 张手 → 球形变换
  - 剪刀手 → "我是 Mok" 文字展示
  - 握拳 → 圆环形态
  - 食指 → 星形图案
  - 竖大拇指 → 爱心形状
- **交互特效**：
  - 手势切换爆炸过渡效果
  - 挥手风暴（快速挥动手掌可吹散粒子）
  - 深度推拉反馈（根据手掌大小实时缩放粒子系统）

### 圣诞树互动系统 (WebARChristmasTree.html)
- **3D圣诞树构建**：30个球体 + 20个立方体 + 15个糖果棍 + 10个照片位
- **三态状态管理**：
  - 合拢态：圣诞树成形（圆锥排列）
  - 散开态：元素漂浮（随机分布）
  - 照片放大态：选中照片放大展示
- **手势控制**：
  - 握拳 → 合拢态
  - 五指张开 → 散开态
  - 抓取 → 选择最近照片并放大
  - 旋转手势 → 相机旋转
- **照片管理**：支持上传、管理、删除照片

## 🎨 全新UI设计（玻璃拟态）

### 统一界面特性
- **玻璃拟态设计**：毛玻璃效果 + 金属质感边框
- **辉光背景**：动态脉冲效果的渐变辉光
- **专业面板系统**：
  - 左侧状态面板（实时显示状态、手势、照片数量、FPS）
  - 右侧手势指示器（图标+文字+颜色编码）
  - 顶部操作按钮（全屏、UI隐藏、帮助）
  - 底部控制面板（状态切换、自动旋转、重置、辉光开关）
  - 右侧上传面板（上传照片、管理照片）

### 交互增强
- **拖拽标题**：可拖动主标题到任意位置
- **键盘快捷键**：
  - `1/2/3`：切换状态
  - `空格`：循环切换
  - `F`：全屏切换
- **UI隐藏/显示**：一键隐藏/显示所有界面元素
- **照片管理器**：网格视图 + 删除功能

## 🔧 技术栈

- **Three.js** - 3D 图形渲染库 (v0.160.0)
- **MediaPipe Hands** - 手势识别 (v0.4.1646424915)
- **后期处理** - UnrealBloomPass 辉光效果
- **WebGL** - GPU 加速图形渲染
- **CDN** - unpkg + jsdelivr 双源加载

## 🚀 运行方式

### 本地运行（推荐）

由于浏览器安全策略限制，需要通过本地服务器运行：

#### 方法一：Python
```bash
# Python 3.x
python -m http.server 8000

# Python 2.x
python -m SimpleHTTPServer 8000
```

#### 方法二：Node.js
```bash
# 安装 http-server
npm install -g http-server

# 启动服务器
http-server -p 8000
```

#### 方法三：VS Code Live Server
安装 "Live Server" 扩展，右键HTML文件选择 "Open with Live Server"

### 访问地址
启动后访问：
- 粒子系统：http://localhost:8000/WebARParticleSystem.html
- 圣诞树系统：http://localhost:8000/WebARChristmasTree.html

### 在线体验
GitHub Pages 部署版本：
- 粒子系统：https://JasonWuyaocheng.github.io/web-ar-particle-system/WebARParticleSystem.html
- 圣诞树系统：https://JasonWuyaocheng.github.io/web-ar-particle-system/WebARChristmasTree.html

## 📱 使用说明

### 通用操作
1. **允许摄像头权限**：首次访问需要点击"允许"授权摄像头
2. **手势操作**：将手掌放置在摄像头前，保持适当距离（30-60cm）
3. **状态提示**：观察顶部状态指示器了解当前状态
4. **自动模式**：如果摄像头不可用，系统会自动进入演示模式

### 粒子系统专属
- **张手**：显示球形粒子阵列
- **剪刀手**：显示"Mok"文字形状
- **握拳**：显示圆环形态
- **食指**：显示星形图案
- **竖大拇指**：显示爱心形状
- **快速挥手**：触发风暴效果

### 圣诞树系统专属
- **照片上传**：点击"上传照片"按钮选择本地图片（最多10张）
- **照片管理**：点击"管理照片"查看、选择、删除照片
- **抓取手势**：在散开态下，抓取动作会自动选择最近的照片并放大
- **相机旋转**：在散开态下，移动手部可旋转视角

## 🛠️ 性能优化

### 粒子系统
- **Fibonacci球面分布**：避免粒子聚集，保证均匀分布
- **粒子尺寸优化**：从3.0降至1.0，解决模糊问题
- **批量更新**：每帧只更新1/2粒子，提高性能
- **几何体复用**：使用BufferGeometry减少内存占用

### 圣诞树系统
- **后期处理控制**：可开关辉光效果
- **动画因子**：根据不同状态调整动画强度
- **纹理管理**：使用dispose()及时释放资源

### 通用优化
- **FPS监控**：实时显示帧率，超过60FPS自动优化
- **内存管理**：照片上传前检查尺寸，过大则压缩
- **错误降级**：摄像头失败自动切换到自动循环模式

## 🎯 键盘快捷键

### 粒子系统
- `1-5`：直接切换到对应手势形态
- `空格`：暂停/恢复动画
- `F`：全屏切换
- `R`：重置所有粒子

### 圣诞树系统
- `1`：切换到合拢态
- `2`：切换到散开态
- `3`：切换到照片放大态（需有照片）
- `空格`：循环切换状态
- `F`：全屏切换

## 📋 系统要求

### 浏览器兼容性
- **支持**：Chrome 90+, Firefox 88+, Edge 90+, Safari 14+
- **需要**：WebGL 支持、摄像头访问权限
- **推荐**：使用现代浏览器以获得最佳性能

### 硬件要求
- **CPU**：建议双核以上
- **内存**：至少 2GB RAM
- **摄像头**：720p 或更高分辨率
- **网络**：首次加载需要下载依赖库（约 5MB）

### 环境要求
- **HTTPS** 或 **localhost**：由于浏览器安全策略，必须在安全环境下运行
- **本地开发**：使用本地服务器（不能直接双击HTML文件）

## 🔍 故障排除

### 常见问题
1. **摄像头无法启动**
   - 检查浏览器权限设置
   - 确保没有其他应用占用摄像头
   - 尝试刷新页面

2. **手势识别不准确**
   - 确保光线充足
   - 手掌正对摄像头
   - 保持适当距离（30-60cm）

3. **性能问题**
   - 关闭辉光效果（点击"✨ 辉光"按钮）
   - 减少照片数量
   - 降低浏览器其他标签页占用

4. **库加载失败**
   - 检查网络连接
   - 刷新页面重新加载
   - 如果CDN不稳定，可下载本地库文件

### 调试信息
- 打开浏览器控制台查看详细日志
- 观察FPS指标了解性能状况
- 使用"隐藏UI"功能查看纯净3D场景

## 📁 文件结构

```
web-ar-particle-system/
├── WebARParticleSystem.html    # 粒子互动系统
├── WebARChristmasTree.html      # 圣诞树互动系统
├── README.md                    # 项目文档
└── screenshots/                 # 截图（可选）
```

## 🎨 设计亮点

### 视觉设计
- **玻璃拟态**：现代感十足的UI设计，半透明磨砂效果
- **金属质感**：金色边框和装饰，高端大气
- **动态辉光**：背景脉冲动画，营造氛围
- **颜色编码**：不同状态使用不同主色调（金/绿/红）

### 交互设计
- **多模态控制**：手势 + 按钮 + 键盘 + 拖拽
- **即时反馈**：所有操作都有视觉和文字提示
- **状态可视化**：实时显示系统状态和性能指标
- **容错设计**：摄像头失败时自动降级到演示模式

### 用户体验
- **零配置**：开箱即用，无需安装
- **响应式**：适配桌面和移动端
- **帮助系统**：内置详细使用说明
- **性能优先**：流畅的60FPS体验

## 🤝 贡献指南

欢迎贡献代码、报告bug或提出建议！

### 开发环境
```bash
# 克隆项目
git clone https://github.com/JasonWuyaocheng/web-ar-particle-system.git

# 启动本地服务器
cd web-ar-particle-system
python -m http.server 8000
```

### 提交规范
- 功能新增：`feat: 添加新功能`
- Bug修复：`fix: 修复bug`
- 文档更新：`docs: 更新文档`

## 📄 许可证

MIT License - 可自由使用、修改和分发

## 🙏 致谢

- **Three.js** - 强大的3D图形库
- **MediaPipe** - 优秀的手势识别方案
- **unpkg/jsdelivr** - 稳定的CDN服务

---

**开发时间**：2025年12月  
**版本**：2.0.0 - 全新UI设计版  
**状态**：✅ 生产环境就绪

如遇问题，请检查控制台错误信息或参考故障排除章节。
